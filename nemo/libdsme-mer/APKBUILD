pkgname=libdsme-mer
pkgver=0.66.0
pkgrel=0
pkgdesc="CPU and display keepalive and scheduling library"
arch="all"
url="https://git.merproject.org/mer-core/libdsme"
license="LGPL-2.1"
depends_dev="glib-dev"
makedepends="check-dev dbus-glib-dev"
source="$pkgname-$pkgver.tar.bz2::https://git.merproject.org/mer-core/libdsme/repository/archive.tar.bz2?ref=$pkgver
    0001-use-standard-uint32_t-integer-type.patch"
subpackages="$pkgname-dev"
_rev=8d7420a5f7ccac6d36ae754dd73d0890fdb70f6b

builddir="$srcdir/libdsme-$pkgver-$_rev"

prepare() {
	default_prepare

	cd "$builddir"
	sed -i -e "s|<sys/un.h>|<sys/uio.h>\n#include <sys/un.h>|g" ./protocol.c
}

build() {
	cd "$builddir"
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir/" install
	rm -rf "$pkgdir/opt"
}
sha512sums="53dbace90c6df7d57fd4b4107be83291a66b8cb0db5c8a7885b362e769a3ab5313885460e75a7a15859ad4f792919522e48127832f11a3750c16decea631c5d4  libdsme-mer-0.66.0.tar.bz2
4fdec17504a47c40aa6f7c373223f40a38e3144f2ad45d2fa1f7c023cc17263e5295832bdc01bede8bda3f6105f451467906d737021f8b902359295a594967b9  0001-use-standard-uint32_t-integer-type.patch"
